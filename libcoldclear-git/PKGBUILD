pkgname=libcold-clear-git
pkgver=v0.1.alpha5.r68.g72cc412
pkgrel=1
pkgdesc="Tetris bot. C API"
arch=('x86_64')
url="https://github.com/MinusKelvin/cold-clear"
license=('MPL2')
makedepends=('git' 'rust')
source=("$pkgname::git+https://github.com/MinusKelvin/cold-clear")
sha256sums=('SKIP')

pkgver() {
    cd "$pkgname"
    git describe --long --tags | sed 's/\([^-]*-g\)/r\1/;s/-/./g'
}

prepare() {
    cd "$srcdir"/"$pkgname"
}

build() {
    # Build cold-clear
    cd "$srcdir"/"$pkgname"/c-api/
    cargo build --release
}

package() {
    install -Dm755 "$srcdir"/"$pkgname"/target/release/libcold_clear.so "$pkgdir"/usr/lib/libcold_clear.so
    install -Dm755 "$srcdir"/"$pkgname"/c-api/coldclear.h "$pkgdir"/usr/include/coldclear.h
    install -Dm0644 $srcdir/$pkgname/LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
}
